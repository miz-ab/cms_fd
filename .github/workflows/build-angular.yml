name: Build Angular CMS App

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
       - name: Show Event Type
         run: echo "ğŸ“¦ Event type: ${{ github.event_name }}"

       - name: Show Branch Name
         run: echo "ğŸŒ¿ Branch: ${{ github.ref }}"

       - name: Log Branch Check
         run: |
          if [[ "${GITHUB_REF}" != "refs/heads/main" ]]; then
            echo "â„¹ï¸ Not on main branch. This workflow is set to only trigger on main."
          else
            echo "âœ… On main branch. Proceeding with build..."
          fi

       - name: Show Triggered By
         run: echo "ğŸš€ Pipeline triggered by ${{ github.actor }}"

       - name: Log Pipeline Start Time
         run: echo "ğŸ•’ Pipeline execution started at $(date)"

       - name: Checkout code
         uses: actions/checkout@v4

       - name: Set up Node.js
         uses: actions/setup-node@v4
         with:
          node-version: '20'

       - name: Install dependencies
         run: npm install

       - name: Build Angular app
         run: npm run build -- --configuration=production
